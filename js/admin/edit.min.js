/*
 MIT
*/
(function(p){"function"===typeof define&&define.amd?define(p):"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=p():"undefined"!==typeof Package?Sortable=p():window.Sortable=p()})(function(){function p(a,b){if(!a||!a.nodeType||1!==a.nodeType)throw"Sortable: `el` must be HTMLElement, and not "+{}.toString.call(a);this.el=a;this.options=b=R({},b);a[C]=this;var c={group:Math.random(),sort:!0,disabled:!1,store:null,handle:null,scroll:!0,scrollSensitivity:30,scrollSpeed:10,
draggable:/[uo]l/i.test(a.nodeName)?"li":">*",ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",ignore:"a, img",filter:null,animation:0,setData:function(a,b){a.setData("Text",b.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1},d;for(d in c)d in b||(b[d]=c[d]);S(b);for(var e in this)"_"===e.charAt(0)&&(this[e]=this[e].bind(this));this.nativeDraggable=b.forceFallback?!1:ca;k(a,"mousedown",this._onTapStart);
k(a,"touchstart",this._onTapStart);this.nativeDraggable&&(k(a,"dragover",this),k(a,"dragenter",this));G.push(this._onDragOver);b.store&&this.sort(b.store.get(this))}function M(a){u&&u.state!==a&&(g(u,"display",a?"none":""),!a&&u.state&&l.insertBefore(u,e),u.state=a)}function x(a,b,c){if(a){c=c||f;do if(">*"===b&&a.parentNode===c||T(a,b))return a;while(a!==c&&(a=a.parentNode))}return null}function k(a,b,c){a.addEventListener(b,c,!1)}function m(a,b,c){a.removeEventListener(b,c,!1)}function D(a,b,c){if(a)if(a.classList)a.classList[c?
"add":"remove"](b);else{var d=(" "+a.className+" ").replace(U," ").replace(" "+b+" "," ");a.className=(d+(c?" "+b:"")).replace(U," ")}}function g(a,b,c){var d=a&&a.style;if(d){if(void 0===c)return f.defaultView&&f.defaultView.getComputedStyle?c=f.defaultView.getComputedStyle(a,""):a.currentStyle&&(c=a.currentStyle),void 0===b?c:c[b];b in d||(b="-webkit-"+b);d[b]=c+("string"===typeof c?"":"px")}}function V(a,b,c){if(a){a=a.getElementsByTagName(b);b=0;var d=a.length;if(c)for(;b<d;b++)c(a[b],b);return a}return[]}
function w(a,b,c,d,e,z,ba){var q=f.createEvent("Event"),g=(a||b[C]).options,h="on"+c.charAt(0).toUpperCase()+c.substr(1);q.initEvent(c,!0,!0);q.to=b;q.from=e||b;q.item=d||b;q.clone=u;q.oldIndex=z;q.newIndex=ba;b.dispatchEvent(q);g[h]&&g[h].call(a,q)}function W(a,b,c,d,e,z){var q,g=a[C],h=g.options.onMove,l;q=f.createEvent("Event");q.initEvent("move",!0,!0);q.to=b;q.from=a;q.dragged=c;q.draggedRect=d;q.related=e||b;q.relatedRect=z||b.getBoundingClientRect();a.dispatchEvent(q);h&&(l=h.call(g,q));return l}
function X(a){a.draggable=!1}function da(){N=!1}function ea(a){a=a.tagName+a.className+a.src+a.href+a.textContent;for(var b=a.length,c=0;b--;)c+=a.charCodeAt(b);return c.toString(36)}function I(a,b){var c=0;if(!a||!a.parentNode)return-1;for(;a&&(a=a.previousElementSibling);)"TEMPLATE"!==a.nodeName.toUpperCase()&&T(a,b)&&c++;return c}function T(a,b){if(a){b=b.split(".");var c=b.shift().toUpperCase(),d=new RegExp("\\s("+b.join("|")+")(?=\\s)","g");return(""===c||a.nodeName.toUpperCase()==c)&&(!b.length||
((" "+a.className+" ").match(d)||[]).length==b.length)}return!1}function Y(a,b){var c,d;return function(){void 0===c&&(c=arguments,d=this,setTimeout(function(){1===c.length?a.call(d,c[0]):a.apply(d,c);c=void 0},b))}}function R(a,b){if(a&&b)for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a}if("undefined"==typeof window||"undefined"==typeof window.document)return function(){throw Error("Sortable.js requires a window with a document");};var e,E,h,u,l,H,t,O,P,J,Q,r,n,A,y={},B,v,K,U=/\s+/g,C="Sortable"+
(new Date).getTime(),F=window,f=F.document,Z=F.parseInt,ca=!!("draggable"in f.createElement("div")),aa=function(a){a=f.createElement("x");a.style.cssText="pointer-events:auto";return"auto"===a.style.pointerEvents}(),N=!1,L=Math.abs,G=[],fa=Y(function(a,b,c){if(c&&b.scroll){var d,e=b.scrollSensitivity,z=b.scrollSpeed,g=a.clientX;a=a.clientY;var h=window.innerWidth,l=window.innerHeight,k,f;if(O!==c&&(t=b.scroll,O=c,!0===t)){t=c;do if(t.offsetWidth<t.scrollWidth||t.offsetHeight<t.scrollHeight)break;
while(t=t.parentNode)}t&&(d=t,b=t.getBoundingClientRect(),k=(L(b.right-g)<=e)-(L(b.left-g)<=e),f=(L(b.bottom-a)<=e)-(L(b.top-a)<=e));k||f||(k=(h-g<=e)-(g<=e),f=(l-a<=e)-(a<=e),(k||f)&&(d=F));if(y.vx!==k||y.vy!==f||y.el!==d)y.el=d,y.vx=k,y.vy=f,clearInterval(y.pid),d&&(y.pid=setInterval(function(){d===F?F.scrollTo(F.pageXOffset+k*z,F.pageYOffset+f*z):(f&&(d.scrollTop+=f*z),k&&(d.scrollLeft+=k*z))},24))}},30),S=function(a){var b=a.group;b&&"object"==typeof b||(b=a.group={name:b});["pull","put"].forEach(function(a){a in
b||(b[a]=!0)});a.groups=" "+b.name+(b.put.join?" "+b.put.join(" "):"")+" "};p.prototype={constructor:p,_onTapStart:function(a){var b=this,c=this.el,d=this.options,e=a.touches&&a.touches[0],g=(e||a).target,h=g,l=d.filter;if(!("mousedown"===a.type&&0!==a.button||d.disabled)&&(g=x(g,d.draggable,c))){r=I(g,d.draggable);if("function"===typeof l){if(l.call(this,a,g,this)){w(b,h,"filter",g,c,r);a.preventDefault();return}}else if(l&&(l=l.split(",").some(function(a){if(a=x(h,a.trim(),c))return w(b,a,"filter",
g,c,r),!0}))){a.preventDefault();return}d.handle&&!x(h,d.handle,c)||this._prepareDragStart(a,e,g)}},_prepareDragStart:function(a,b,c){var d=this,g=d.el,h=d.options,f=g.ownerDocument;c&&!e&&c.parentNode===g&&(B=a,l=g,e=c,E=e.parentNode,H=e.nextSibling,A=h.group,a=function(){d._disableDelayedDrag();e.draggable=!0;D(e,d.options.chosenClass,!0);d._triggerDragStart(b)},h.ignore.split(",").forEach(function(a){V(e,a.trim(),X)}),k(f,"mouseup",d._onDrop),k(f,"touchend",d._onDrop),k(f,"touchcancel",d._onDrop),
h.delay?(k(f,"mouseup",d._disableDelayedDrag),k(f,"touchend",d._disableDelayedDrag),k(f,"touchcancel",d._disableDelayedDrag),k(f,"mousemove",d._disableDelayedDrag),k(f,"touchmove",d._disableDelayedDrag),d._dragStartTimer=setTimeout(a,h.delay)):a())},_disableDelayedDrag:function(){var a=this.el.ownerDocument;clearTimeout(this._dragStartTimer);m(a,"mouseup",this._disableDelayedDrag);m(a,"touchend",this._disableDelayedDrag);m(a,"touchcancel",this._disableDelayedDrag);m(a,"mousemove",this._disableDelayedDrag);
m(a,"touchmove",this._disableDelayedDrag)},_triggerDragStart:function(a){a?(B={target:e,clientX:a.clientX,clientY:a.clientY},this._onDragStart(B,"touch")):this.nativeDraggable?(k(e,"dragend",this),k(l,"dragstart",this._onDragStart)):this._onDragStart(B,!0);try{f.selection?f.selection.empty():window.getSelection().removeAllRanges()}catch(b){}},_dragStarted:function(){l&&e&&(D(e,this.options.ghostClass,!0),p.active=this,w(this,l,"start",e,l,r))},_emulateDragOver:function(){if(v&&(this._lastX!==v.clientX||
this._lastY!==v.clientY)){this._lastX=v.clientX;this._lastY=v.clientY;aa||g(h,"display","none");var a=f.elementFromPoint(v.clientX,v.clientY),b=a,c=" "+this.options.group.name+"",d=G.length;if(b){do{if(b[C]&&-1<b[C].options.groups.indexOf(c)){for(;d--;)G[d]({clientX:v.clientX,clientY:v.clientY,target:a,rootEl:b});break}a=b}while(b=b.parentNode)}aa||g(h,"display","")}},_onTouchMove:function(a){if(B){p.active||this._dragStarted();this._appendGhost();var b=a.touches?a.touches[0]:a,c=b.clientX-B.clientX,
d=b.clientY-B.clientY,c=a.touches?"translate3d("+c+"px,"+d+"px,0)":"translate("+c+"px,"+d+"px)";K=!0;v=b;g(h,"webkitTransform",c);g(h,"mozTransform",c);g(h,"msTransform",c);g(h,"transform",c);a.preventDefault()}},_appendGhost:function(){if(!h){var a=e.getBoundingClientRect(),b=g(e),c=this.options;h=e.cloneNode(!0);D(h,c.ghostClass,!1);D(h,c.fallbackClass,!0);g(h,"top",a.top-Z(b.marginTop,10));g(h,"left",a.left-Z(b.marginLeft,10));g(h,"width",a.width);g(h,"height",a.height);g(h,"opacity","0.8");g(h,
"position","fixed");g(h,"zIndex","100000");g(h,"pointerEvents","none");c.fallbackOnBody&&f.body.appendChild(h)||l.appendChild(h);b=h.getBoundingClientRect();g(h,"width",2*a.width-b.width);g(h,"height",2*a.height-b.height)}},_onDragStart:function(a,b){var c=a.dataTransfer,d=this.options;this._offUpEvents();"clone"==A.pull&&(u=e.cloneNode(!0),g(u,"display","none"),l.insertBefore(u,e));b?("touch"===b?(k(f,"touchmove",this._onTouchMove),k(f,"touchend",this._onDrop),k(f,"touchcancel",this._onDrop)):(k(f,
"mousemove",this._onTouchMove),k(f,"mouseup",this._onDrop)),this._loopId=setInterval(this._emulateDragOver,50)):(c&&(c.effectAllowed="move",d.setData&&d.setData.call(this,c,e)),k(f,"drop",this),setTimeout(this._dragStarted,0))},_onDragOver:function(a){var b=this.el,c,d,f;d=this.options;c=d.group;var k=c.put,m=A===c,p=d.sort;void 0!==a.preventDefault&&(a.preventDefault(),!d.dragoverBubble&&a.stopPropagation());K=!0;if(A&&!d.disabled&&(m?p||(f=!l.contains(e)):A.pull&&k&&(A.name===c.name||k.indexOf&&
~k.indexOf(A.name)))&&(void 0===a.rootEl||a.rootEl===this.el)&&(fa(a,d,this.el),!N))if(c=x(a.target,d.draggable,b),d=e.getBoundingClientRect(),f)M(!0),u||H?l.insertBefore(e,u||H):p||l.appendChild(e);else if(!(f=0===b.children.length||b.children[0]===h)&&(f=b===a.target)&&(c=b.lastElementChild,f=c.getBoundingClientRect(),f=c=(5<a.clientY-(f.top+f.height)||5<a.clientX-(f.right+f.width))&&c),f){if(c){if(c.animated)return;n=c.getBoundingClientRect()}M(m);!1!==W(l,b,e,d,c,n)&&(e.contains(b)||(b.appendChild(e),
E=b),this._animate(d,e),c&&this._animate(n,c))}else if(c&&!c.animated&&c!==e&&void 0!==c.parentNode[C]){P!==c&&(P=c,J=g(c),Q=g(c.parentNode));var n=c.getBoundingClientRect(),t=n.right-n.left,r=n.bottom-n.top,p=/left|right|inline/.test(J.cssFloat+J.display)||"flex"==Q.display&&0===Q["flex-direction"].indexOf("row");f=c.offsetWidth>e.offsetWidth;k=c.offsetHeight>e.offsetHeight;t=.5<(p?(a.clientX-n.left)/t:(a.clientY-n.top)/r);a=c.nextElementSibling;r=W(l,b,e,d,c,n);!1!==r&&(N=!0,setTimeout(da,30),M(m),
1===r||-1===r?m=1===r:p?(m=e.offsetTop,p=c.offsetTop,m=m===p?c.previousElementSibling===e&&!f||t&&f:p>m):m=a!==e&&!k||t&&k,e.contains(b)||(m&&!a?b.appendChild(e):c.parentNode.insertBefore(e,m?a:c)),E=e.parentNode,this._animate(d,e),this._animate(n,c))}},_animate:function(a,b){var c=this.options.animation;if(c){var d=b.getBoundingClientRect();g(b,"transition","none");g(b,"transform","translate3d("+(a.left-d.left)+"px,"+(a.top-d.top)+"px,0)");b.offsetWidth;g(b,"transition","all "+c+"ms");g(b,"transform",
"translate3d(0,0,0)");clearTimeout(b.animated);b.animated=setTimeout(function(){g(b,"transition","");g(b,"transform","");b.animated=!1},c)}},_offUpEvents:function(){var a=this.el.ownerDocument;m(f,"touchmove",this._onTouchMove);m(a,"mouseup",this._onDrop);m(a,"touchend",this._onDrop);m(a,"touchcancel",this._onDrop)},_onDrop:function(a){var b=this.el,c=this.options;clearInterval(this._loopId);clearInterval(y.pid);clearTimeout(this._dragStartTimer);m(f,"mousemove",this._onTouchMove);this.nativeDraggable&&
(m(f,"drop",this),m(b,"dragstart",this._onDragStart));this._offUpEvents();if(a&&(K&&(a.preventDefault(),!c.dropBubble&&a.stopPropagation()),h&&h.parentNode.removeChild(h),e&&(this.nativeDraggable&&m(e,"dragend",this),X(e),D(e,this.options.ghostClass,!1),D(e,this.options.chosenClass,!1),l!==E?(n=I(e,c.draggable),0<=n&&(w(null,E,"sort",e,l,r,n),w(this,l,"sort",e,l,r,n),w(null,E,"add",e,l,r,n),w(this,l,"remove",e,l,r,n))):(u&&u.parentNode.removeChild(u),e.nextSibling!==H&&(n=I(e,c.draggable),0<=n&&(w(this,
l,"update",e,l,r,n),w(this,l,"sort",e,l,r,n)))),p.active))){if(null===n||-1===n)n=r;w(this,l,"end",e,l,r,n);this.save()}this._nulling()},_nulling:function(){l=e=E=h=H=u=t=O=B=v=K=n=P=J=A=p.active=null},handleEvent:function(a){var b=a.type;"dragover"===b||"dragenter"===b?e&&(this._onDragOver(a),a.dataTransfer&&(a.dataTransfer.dropEffect="move"),a.preventDefault()):"drop"!==b&&"dragend"!==b||this._onDrop(a)},toArray:function(){for(var a=[],b,c=this.el.children,d=0,e=c.length,f=this.options;d<e;d++)b=
c[d],x(b,f.draggable,this.el)&&a.push(b.getAttribute(f.dataIdAttr)||ea(b));return a},sort:function(a){var b={},c=this.el;this.toArray().forEach(function(a,e){var d=c.children[e];x(d,this.options.draggable,c)&&(b[a]=d)},this);a.forEach(function(a){b[a]&&(c.removeChild(b[a]),c.appendChild(b[a]))})},save:function(){var a=this.options.store;a&&a.set(this)},closest:function(a,b){return x(a,b||this.options.draggable,this.el)},option:function(a,b){var c=this.options;if(void 0===b)return c[a];c[a]=b;"group"===
a&&S(c)},destroy:function(){var a=this.el;a[C]=null;m(a,"mousedown",this._onTapStart);m(a,"touchstart",this._onTapStart);this.nativeDraggable&&(m(a,"dragover",this),m(a,"dragenter",this));Array.prototype.forEach.call(a.querySelectorAll("[draggable]"),function(a){a.removeAttribute("draggable")});G.splice(G.indexOf(this._onDragOver),1);this._onDrop();this.el=a=null}};p.utils={on:k,off:m,css:g,find:V,is:function(a,b){return!!x(a,b,a)},extend:R,throttle:Y,closest:x,toggleClass:D,index:I};p.create=function(a,
b){return new p(a,b)};p.version="1.4.2";return p});
/*
 MIT
*/
(function(c){"function"===typeof define&&define.amd?define(["jquery"],c):c(jQuery)})(function(c){c.fn.sortable=function(b){var d,f=arguments;this.each(function(){var e=c(this),a=e.data("sortable");a||!(b instanceof Object)&&b||(a=new Sortable(this,b),e.data("sortable",a));if(a){if("widget"===b)return a;"destroy"===b?(a.destroy(),e.removeData("sortable")):"function"===typeof a[b]?d=a[b].apply(a,[].slice.call(f,1)):b in a.options&&(d=a.option.apply(a,f))}});return void 0===d?this:d}});
(function(d,b){String.prototype.removeAccents=function(){var a={A:/[A\u24b6\uff21\u00c0\u00c1\u00c2\u1ea6\u1ea4\u1eaa\u1ea8\u00c3\u0100\u0102\u1eb0\u1eae\u1eb4\u1eb2\u0226\u01e0\u00c4\u01de\u1ea2\u00c5\u01fa\u01cd\u0200\u0202\u1ea0\u1eac\u1eb6\u1e00\u0104]/g,AA:/[\ua732]/g,AE:/[\u00c6\u01fc\u01e2]/g,AO:/[\ua734]/g,AU:/[\ua736]/g,AV:/[\ua738\ua73a]/g,AY:/[\ua73c]/g,B:/[B\u24b7\uff22\u1e02\u1e04\u1e06\u0243\u0182\u0181]/g,C:/[C\u24b8\uff23\u0106\u0108\u010a\u010c\u00c7\u1e08\u0187\u023b\ua73e]/g,D:/[D\u24b9\uff24\u1e0a\u010e\u1e0c\u1e10\u1e12\u1e0e\u0110\u018b\u018a\u0189\ua779]/g,
DZ:/[\u01f1\u01c4]/g,Dz:/[\u01f2\u01c5]/g,E:/[E\u24ba\uff25\u00c8\u00c9\u00ca\u1ec0\u1ebe\u1ec4\u1ec2\u1ebc\u0112\u1e14\u1e16\u0114\u0116\u00cb\u1eba\u011a\u0204\u0206\u1eb8\u1ec6\u0228\u1e1c\u0118\u1e18\u1e1a\u0190\u018e]/g,F:/[F\u24bb\uff26\u1e1e\u0191\ua77b]/g,G:/[G\u24bc\uff27\u01f4\u011c\u1e20\u011e\u0120\u01e6\u0122\u01e4\u0193\ua7a0\ua77d\ua77e]/g,H:/[H\u24bd\uff28\u0124\u1e22\u1e26\u021e\u1e24\u1e28\u1e2a\u0126\u2c67\u2c75\ua78d]/g,I:/[I\u24be\uff29\u00cc\u00cd\u00ce\u0128\u012a\u012c\u0130\u00cf\u1e2e\u1ec8\u01cf\u0208\u020a\u1eca\u012e\u1e2c\u0197]/g,
J:/[J\u24bf\uff2a\u0134\u0248]/g,K:/[K\u24c0\uff2b\u1e30\u01e8\u1e32\u0136\u1e34\u0198\u2c69\ua740\ua742\ua744\ua7a2]/g,L:/[L\u24c1\uff2c\u013f\u0139\u013d\u1e36\u1e38\u013b\u1e3c\u1e3a\u0141\u023d\u2c62\u2c60\ua748\ua746\ua780]/g,LJ:/[\u01c7]/g,Lj:/[\u01c8]/g,M:/[M\u24c2\uff2d\u1e3e\u1e40\u1e42\u2c6e\u019c]/g,N:/[N\u24c3\uff2e\u01f8\u0143\u00d1\u1e44\u0147\u1e46\u0145\u1e4a\u1e48\u0220\u019d\ua790\ua7a4]/g,NJ:/[\u01ca]/g,Nj:/[\u01cb]/g,O:/[O\u24c4\uff2f\u00d2\u00d3\u00d4\u1ed2\u1ed0\u1ed6\u1ed4\u00d5\u1e4c\u022c\u1e4e\u014c\u1e50\u1e52\u014e\u022e\u0230\u00d6\u022a\u1ece\u0150\u01d1\u020c\u020e\u01a0\u1edc\u1eda\u1ee0\u1ede\u1ee2\u1ecc\u1ed8\u01ea\u01ec\u00d8\u01fe\u0186\u019f\ua74a\ua74c]/g,
OI:/[\u01a2]/g,OO:/[\ua74e]/g,OU:/[\u0222]/g,P:/[P\u24c5\uff30\u1e54\u1e56\u01a4\u2c63\ua750\ua752\ua754]/g,Q:/[Q\u24c6\uff31\ua756\ua758\u024a]/g,R:/[R\u24c7\uff32\u0154\u1e58\u0158\u0210\u0212\u1e5a\u1e5c\u0156\u1e5e\u024c\u2c64\ua75a\ua7a6\ua782]/g,S:/[S\u24c8\uff33\u1e9e\u015a\u1e64\u015c\u1e60\u0160\u1e66\u1e62\u1e68\u0218\u015e\u2c7e\ua7a8\ua784]/g,T:/[T\u24c9\uff34\u1e6a\u0164\u1e6c\u021a\u0162\u1e70\u1e6e\u0166\u01ac\u01ae\u023e\ua786]/g,TZ:/[\ua728]/g,U:/[U\u24ca\uff35\u00d9\u00da\u00db\u0168\u1e78\u016a\u1e7a\u016c\u00dc\u01db\u01d7\u01d5\u01d9\u1ee6\u016e\u0170\u01d3\u0214\u0216\u01af\u1eea\u1ee8\u1eee\u1eec\u1ef0\u1ee4\u1e72\u0172\u1e76\u1e74\u0244]/g,
V:/[V\u24cb\uff36\u1e7c\u1e7e\u01b2\ua75e\u0245]/g,VY:/[\ua760]/g,W:/[W\u24cc\uff37\u1e80\u1e82\u0174\u1e86\u1e84\u1e88\u2c72]/g,X:/[X\u24cd\uff38\u1e8a\u1e8c]/g,Y:/[Y\u24ce\uff39\u1ef2\u00dd\u0176\u1ef8\u0232\u1e8e\u0178\u1ef6\u1ef4\u01b3\u024e\u1efe]/g,Z:/[Z\u24cf\uff3a\u0179\u1e90\u017b\u017d\u1e92\u1e94\u01b5\u0224\u2c7f\u2c6b\ua762]/g,a:/[a\u24d0\uff41\u1e9a\u00e0\u00e1\u00e2\u1ea7\u1ea5\u1eab\u1ea9\u00e3\u0101\u0103\u1eb1\u1eaf\u1eb5\u1eb3\u0227\u01e1\u00e4\u01df\u1ea3\u00e5\u01fb\u01ce\u0201\u0203\u1ea1\u1ead\u1eb7\u1e01\u0105\u2c65\u0250]/g,
aa:/[\ua733]/g,ae:/[\u00e6\u01fd\u01e3]/g,ao:/[\ua735]/g,au:/[\ua737]/g,av:/[\ua739\ua73b]/g,ay:/[\ua73d]/g,b:/[b\u24d1\uff42\u1e03\u1e05\u1e07\u0180\u0183\u0253]/g,c:/[c\u24d2\uff43\u0107\u0109\u010b\u010d\u00e7\u1e09\u0188\u023c\ua73f\u2184]/g,d:/[d\u24d3\uff44\u1e0b\u010f\u1e0d\u1e11\u1e13\u1e0f\u0111\u018c\u0256\u0257\ua77a]/g,dz:/[\u01f3\u01c6]/g,e:/[e\u24d4\uff45\u00e8\u00e9\u00ea\u1ec1\u1ebf\u1ec5\u1ec3\u1ebd\u0113\u1e15\u1e17\u0115\u0117\u00eb\u1ebb\u011b\u0205\u0207\u1eb9\u1ec7\u0229\u1e1d\u0119\u1e19\u1e1b\u0247\u025b\u01dd]/g,
f:/[f\u24d5\uff46\u1e1f\u0192\ua77c]/g,g:/[g\u24d6\uff47\u01f5\u011d\u1e21\u011f\u0121\u01e7\u0123\u01e5\u0260\ua7a1\u1d79\ua77f]/g,h:/[h\u24d7\uff48\u0125\u1e23\u1e27\u021f\u1e25\u1e29\u1e2b\u1e96\u0127\u2c68\u2c76\u0265]/g,hv:/[\u0195]/g,i:/[i\u24d8\uff49\u00ec\u00ed\u00ee\u0129\u012b\u012d\u00ef\u1e2f\u1ec9\u01d0\u0209\u020b\u1ecb\u012f\u1e2d\u0268\u0131]/g,j:/[j\u24d9\uff4a\u0135\u01f0\u0249]/g,k:/[k\u24da\uff4b\u1e31\u01e9\u1e33\u0137\u1e35\u0199\u2c6a\ua741\ua743\ua745\ua7a3]/g,l:/[l\u24db\uff4c\u0140\u013a\u013e\u1e37\u1e39\u013c\u1e3d\u1e3b\u017f\u0142\u019a\u026b\u2c61\ua749\ua781\ua747]/g,
lj:/[\u01c9]/g,m:/[m\u24dc\uff4d\u1e3f\u1e41\u1e43\u0271\u026f]/g,n:/[n\u24dd\uff4e\u01f9\u0144\u00f1\u1e45\u0148\u1e47\u0146\u1e4b\u1e49\u019e\u0272\u0149\ua791\ua7a5]/g,nj:/[\u01cc]/g,o:/[o\u24de\uff4f\u00f2\u00f3\u00f4\u1ed3\u1ed1\u1ed7\u1ed5\u00f5\u1e4d\u022d\u1e4f\u014d\u1e51\u1e53\u014f\u022f\u0231\u00f6\u022b\u1ecf\u0151\u01d2\u020d\u020f\u01a1\u1edd\u1edb\u1ee1\u1edf\u1ee3\u1ecd\u1ed9\u01eb\u01ed\u00f8\u01ff\u0254\ua74b\ua74d\u0275]/g,oi:/[\u01a3]/g,ou:/[\u0223]/g,oo:/[\ua74f]/g,p:/[p\u24df\uff50\u1e55\u1e57\u01a5\u1d7d\ua751\ua753\ua755]/g,
q:/[q\u24e0\uff51\u024b\ua757\ua759]/g,r:/[r\u24e1\uff52\u0155\u1e59\u0159\u0211\u0213\u1e5b\u1e5d\u0157\u1e5f\u024d\u027d\ua75b\ua7a7\ua783]/g,s:/[s\u24e2\uff53\u00df\u015b\u1e65\u015d\u1e61\u0161\u1e67\u1e63\u1e69\u0219\u015f\u023f\ua7a9\ua785\u1e9b]/g,t:/[t\u24e3\uff54\u1e6b\u1e97\u0165\u1e6d\u021b\u0163\u1e71\u1e6f\u0167\u01ad\u0288\u2c66\ua787]/g,tz:/[\ua729]/g,u:/[u\u24e4\uff55\u00f9\u00fa\u00fb\u0169\u1e79\u016b\u1e7b\u016d\u00fc\u01dc\u01d8\u01d6\u01da\u1ee7\u016f\u0171\u01d4\u0215\u0217\u01b0\u1eeb\u1ee9\u1eef\u1eed\u1ef1\u1ee5\u1e73\u0173\u1e77\u1e75\u0289]/g,
v:/[v\u24e5\uff56\u1e7d\u1e7f\u028b\ua75f\u028c]/g,vy:/[\ua761]/g,w:/[w\u24e6\uff57\u1e81\u1e83\u0175\u1e87\u1e85\u1e98\u1e89\u2c73]/g,x:/[x\u24e7\uff58\u1e8b\u1e8d]/g,y:/[y\u24e8\uff59\u1ef3\u00fd\u0177\u1ef9\u0233\u1e8f\u00ff\u1ef7\u1e99\u1ef5\u01b4\u024f\u1eff]/g,z:/[z\u24e9\uff5a\u017a\u1e91\u017c\u017e\u1e93\u1e95\u01b6\u0225\u0240\u2c6c\ua763]/g},b=this,c;for(c in a)b=b.replace(a[c],c);return b};var f=b.grid={};b.grid.model={};b.grid.view={ui:{},element:{}};b.grid.controller={};b.grid.templates=
{};b.grid.utils={sanitizeTitle:function(a){a=a.removeAccents().toLowerCase();a=a.replace(/[^a-z0-9]/g,"-");a=a.replace(/-+/g,"-");return a=a.replace(/-+$/g,"")}};b.grid.controller.Grid=function(){this.$input=d('[name="_grid_data"]');var a=this,e=this.$input.attr("value");data=JSON.parse(e);this.model=new f.model.GridObject(data);this.subviews=new Backbone.Collection([]);this.selected=!1;this.listenTo(this.model,"change",this.onChangeModel);this.view=new b.grid.view.ui.Editor({controller:this,model:this.model});
this.view.setActiveEditor();this.view.$el.insertAfter("#wp-content-wrap");this.view.render();this.view.$el.focus();d(document).on("click",'[type="submit"]',function(b){a.onChangeModel()})};_.extend(b.grid.controller.Grid.prototype,{whichView:function(){return this.view.whichView()},getSelected:function(a){return this.selected},setSelected:function(a){this.selected=a;return this},onChangeModel:function(){var a=JSON.stringify(this.model.toJSON());this.$input.val(a)}},Backbone.Events);_.extend(b.grid.controller.Grid,
Backbone.Events)})(jQuery,window);
(function(e,c){var f,g,d=gridbuilder.options,h=0;f=c.model.GridObject=Backbone.Model.extend({parent:!1,locks:{},initialize:function(a){_.defaults(a,{items:[]});var b=this;this.items=new g([]);this.items.parent=this;this.parent=!1;this.id="obj"+h++;_.each(a.items,function(a,c){b.items.add(a)});delete a.items;Backbone.Model.prototype.initialize.apply(this,arguments)},setItemParent:function(a){a.parent=this},toJSON:function(a){var b=Backbone.Model.prototype.toJSON.apply(this,arguments);b.items=this.items.toJSON(a);
return b}});g=c.model.GridCollection=Backbone.Collection.extend({model:f,comparator:function(a){return a.get("idx")},add:function(){var a=Backbone.Collection.prototype.add.apply(this,arguments),b=this;modelsArr=a.constructor==Array?a:[a];_.each(modelsArr,function(a,c){a.parent=b.parent});return a}});GridTemplate=c.model.GridTemplate=Backbone.Model.extend({save:function(){var a=this;e.ajax({method:"post",url:d.ajaxurl,complete:function(a,c){},success:function(b,c,d){_.each(b,function(b,c){a.set(c,
b)});a.trigger("sync")},data:{action:this.isNew()?"gridbuilder-create-template":"gridbuilder-update-template",nonce:this.isNew()?d.create_template_nonce:d.update_template_nonce,template:JSON.stringify(this.toJSON())}})},destroy:function(){var a=this;e.ajax({method:"post",url:d.ajaxurl,complete:function(a,c){},success:function(b,c,d){a.trigger("destroy",a,a.collection)},data:{action:"gridbuilder-delete-template",nonce:d.delete_template_nonce,template:JSON.stringify(this.toJSON())}})}});_.extend(c.templates,
{get:function(a,b){a=a.toLowerCase();return c.templates[a]._byId[b]}});_.each(d.templates,function(a,b){c.templates[b]=new Backbone.Collection;_.each(a,function(a,d){var e=new c.model.GridTemplate({name:a.name,slug:a.slug,data:a.data,type:b});e.set("id",a.slug);c.templates[b].add(e)})})})(jQuery,window.grid);
var $jscomp={scope:{},findInternal:function(b,d,f){b instanceof String&&(b=String(b));for(var g=b.length,k=0;k<g;k++){var l=b[k];if(d.call(f,l,k,b))return{i:k,v:l}}return{i:-1,v:void 0}}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(b,d,f){if(f.get||f.set)throw new TypeError("ES3 does not support getters and setters.");b!=Array.prototype&&b!=Object.prototype&&(b[d]=f.value)};
$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global&&null!=global?global:b};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(b,d,f,g){if(d){f=$jscomp.global;b=b.split(".");for(g=0;g<b.length-1;g++){var k=b[g];k in f||(f[k]={});f=f[k]}b=b[b.length-1];g=f[b];d=d(g);d!=g&&null!=d&&$jscomp.defineProperty(f,b,{configurable:!0,writable:!0,value:d})}};
$jscomp.polyfill("Array.prototype.find",function(b){return b?b:function(d,b){return $jscomp.findInternal(this,d,b).v}},"es6-impl","es3");
(function(b,d){var f,g=gridbuilder.l10n,k=gridbuilder.options,l=gridbuilder.options.features;d.view.ui.Prompt=wp.media.View.extend({tagName:"div",className:"grid-prompt",template:wp.template("grid-ui-prompt"),events:{"click .btn-confirm":"confirm","click .btn-cancel":"close"},initialize:function(a){_.defaults(a,{defaultValue:"",title:"",message:"",parent:!1});wp.media.View.prototype.initialize.apply(this,arguments);this.$parent=b(a.parent?a.parent:"body");return this.render()},render:function(){wp.media.View.prototype.render.apply(this,
arguments);return this},open:function(){this.$parent.append(this.$el);this.$('[type="text"]').focus().select();return this},close:function(){this.$el.remove();return this},confirm:function(){this.trigger("confirm");this.close()},getValue:function(){return this.$('[type="text"]').val()}});f=d.view.ui.Modal=wp.media.view.Modal.extend({template:wp.template("grid-ui-modal"),events:{"click .media-modal-prev":"prev","click .media-modal-next":"next","click .media-modal-backdrop, .media-modal-close":"escapeHandler",
keydown:"keydown"},initialize:function(){var a=wp.media.view.Modal.prototype.initialize.apply(this,arguments);this.prevnext=!_.isUndefined(this.options.prev)&&!_.isUndefined(this.options.next);return a},render:function(){var a=wp.media.view.Modal.prototype.render.apply(this,arguments);this.prevnext?(this.$(".media-modal-prev").prop("disabled",!this.options.prev),this.$(".media-modal-next").prop("disabled",!this.options.next)):this.$(".media-modal-prev, .media-modal-next").remove();return a},open:function(){wp.media.view.Modal.prototype.open.apply(this,
arguments);b("body").removeClass("modal-open").addClass("grid-modal-open")},close:function(a){wp.media.view.Modal.prototype.close.apply(this,arguments);b("body").removeClass("grid-modal-open")},next:function(){this.trigger("next");return!1},prev:function(){this.trigger("prev");return!1}});d.view.ui.Dialog=wp.media.View.extend({initialize:function(a){this.model=a.model;this.controller=a.controller;this.okayBtn=new wp.media.view.Button({text:g.Done,classes:["apply","button-primary"]});return this},
render:function(){wp.media.View.prototype.render.apply(this,arguments);this.$(".grid-dialog-title").text(this.options.title);this.okayBtn.render();this.$(".grid-dialog-toolbar").append(this.okayBtn.$el)},dismiss:function(){this.$(".grid-dialog-content").html("")}});d.view.ui.Toolbar=wp.media.View.extend({template:wp.template("grid-ui-toolbar"),className:"grid-toolbar",tagName:"div",events:{'click .viewswitcher [type="radio"]':"switchView",'click .set-visibility [type="radio"]':"setVisible","click button.add-item":"addItem",
"change select.add-item":"addTemplateItem","click .item-action.edit":"editItem","click .item-action.clone":"cloneItem","click .item-action.delete":"deleteItem","click .item-action.lock":"lockItem","click .create-template":"createTemplate","click .update-template":"updateTemplate","click .manage-templates":"manageTemplates"},initialize:function(){wp.media.View.prototype.initialize.apply(this,arguments);this.delegateEvents();this.setupSticky()},render:function(){wp.media.View.prototype.render.apply(this,
arguments);this.setupViewswitcher();this.setupTemplateSelects();this.updateWidth();(viewSize=window.getUserSetting("grid-view-size"))?this.$('.viewswitcher [value="'+viewSize+'"]').prop("checked",!0):this.$('.viewswitcher [type="radio"]:last').prop("checked",!0);this.switchView()},preventDefault:function(a){a.preventDefault()},addItem:function(a){this.trigger("add:"+b(a.target).data("add-item"));a.preventDefault()},addTemplateItem:function(a){this.trigger("add:"+b(a.target).data("add-item"),b(a.target).val());
b(a.target).val("");a.preventDefault()},editItem:function(a){this.trigger("edit");a.preventDefault()},cloneItem:function(a){this.trigger("clone");a.preventDefault()},deleteItem:function(a){this.trigger("delete");a.preventDefault()},lockItem:function(a){this.trigger("lock");a.preventDefault()},setVisible:function(){this.trigger("visible",this.$('.set-visibility [type="radio"]:checked').val())},setupSticky:function(){var a=this;b(window).on("scroll",function(){var c="true"===a.$el.attr("data-sticky"),
e=b(window).scrollTop()+33>=a.controller.$el.offset().top;c!=e&&a.$el.attr("data-sticky",e.toString())});b(window).on("resize",function(){a.updateWidth()})},updateWidth:function(){this.$el.css("width",this.controller.$el.width().toString()+"px")},update:function(){var a=this.controller.getSelected(),c=can_create_template=can_update_template=can_edit=can_clone=can_delete=can_lock=!1,e=can_add_row=can_add_cell=can_add_widget=!1;if(a){var e=a.is(d.view.element.Grid),c=l.locks||!a.model.get("locked"),
q=l.locks||!(a.parent()&&a.parent().model.get("locked")),h=a.closest(d.view.element.Grid),g=a.closest(d.view.element.Container),f=a.closest(d.view.element.Row),k=a.closest(d.view.element.Cell),p=a.model.get("visibility_"+this.whichView())||"";can_edit=!e&&c;can_clone=!e&&c&&q;can_delete=!e&&c&&q;can_lock=!0;c=!e;can_create_template=!e;can_update_template=!e&&!!a.model.get("template");e=l.locks||!h.model.get("locked");can_add_row=!!g&&(l.locks||!g.model.get("locked"));can_add_cell=!!f&&(l.locks||!f.model.get("locked"));
can_add_widget=!!k&&(l.locks||!k.model.get("locked"));this.$(".item-action.lock").prop("checked",!!a.model.get("locked"));this.$('[name="set-visibility"]').each(function(a,c){var e=b(this);e.prop("checked",e.val()==p)})}this.$(".item-action.edit").prop("disabled",!can_edit);this.$(".item-action.clone").prop("disabled",!can_clone);this.$(".item-action.delete").prop("disabled",!can_delete);this.$(".item-action.lock").prop("disabled",!can_lock);this.$(".create-template").prop("disabled",!can_create_template);
this.$(".update-template").prop("disabled",!can_update_template);this.$(".manage-templates").prop("disabled",!1);this.$(".add-container").prop("disabled",!e);this.$(".add-row").prop("disabled",!can_add_row);this.$(".add-cell").prop("disabled",!can_add_cell);this.$(".add-widget").prop("disabled",!can_add_widget);this.$('[name="set-visibility"]').prop("disabled",!c)},setupViewswitcher:function(){var a=this;_.each(k.screensizes.sizes,function(c,e){var d={size:e};_.extend(d,c);d=wp.template("viewsize-item")(d);
a.$(".viewswitcher").append(d)})},setupTemplateSelects:function(){this.$("select.add-item[data-add-item]").each(function(){var a=b(this),c=a.attr("data-add-item");b(this).find('[value!=""]').remove();d.templates[c].each(function(e,q){var h=d.templates[c].get(e.id).toJSON();b('<option value="'+h.id+'">'+h.name+"</option>").appendTo(a)})})},switchView:function(){var a=this.whichView();this.$el.attr("data-view-size");a&&(this.trigger("viewsize",this),window.setUserSetting("grid-view-size",a))},whichView:function(){return this.$(".viewswitcher :checked").val()},
delegateEvents:function(){wp.media.View.prototype.delegateEvents.apply(this,arguments);this.on("viewsize",this.updateVisibilitySelect,this);this.on("select",this.updateVisibilitySelect,this);this.on("select",this.updateLockButton,this)},undelegateEvents:function(){wp.media.View.prototype.undelegateEvents.apply(this,arguments)},updateVisibilitySelect:function(){var a=this.controller.getSelected();a&&!a.is(d.view.element.Grid)&&(a=a.model.get("visibility_"+this.whichView())||"",this.$('[name="set-visibility"][value="'+
a+'"]').prop("checked",!0))},updateLockButton:function(){var a=this.getSelected();a&&!a.is(d.view.element.Grid)&&this.$(".item-action.lock").prop("checked",!!a.model.get("locked"))},createTemplate:function(a){this.trigger("create:template");a.preventDefault()},updateTemplate:function(a){this.trigger("update:template");a.preventDefault()},manageTemplates:function(a){this.trigger("manage:templates");a.preventDefault()}});Editor=d.view.ui.Editor=wp.media.View.extend({className:"grid-editor",tagName:"div",
selectWidgetModal:null,events:{"focusout *":function(a){},"focusin *":function(a){(a=b(a.target).data("view"))&&this.setSelected(a)},"keyup *":function(a){var c,e=this.toolbar.whichView(),b=this.getSelected();if(b)switch(a.keyCode){case 13:(c=l.locks||!b.model.get("locked"))&&this.editItem();break;case 46:case 8:(c=l.locks||!b.model.get("locked"))&&this.deleteItem();a.preventDefault();a.stopPropagation();break;case 37:case 39:case 38:case 40:c=a.shiftKey?"size":"offset",(c=l.locks||!b.model.get("locked")&&
!b.model.get(c+"_"+e+":locked"))&&b.is(d.view.element.Cell)&&(37==a.keyCode?a.shiftKey?b.decrementSize():b.decrementOffset():39==a.keyCode&&(a.shiftKey?b.incrementSize():b.incrementOffset())),a.stopPropagation()}}},initialize:function(){wp.media.View.prototype.initialize.apply(this,arguments);this.toolbar=new d.view.ui.Toolbar({controller:this});this.grid=new d.view.element.Grid({controller:this,model:this.model});this.bindEvents()},bindEvents:function(){var a=this;b(document).on("click",function(){a.checkSelected.apply(a,
arguments)});b(document).on("keydown",this.preventBackspaceNav);this.toolbar.on("edit",this.editItem,this);this.toolbar.on("clone",this.cloneItem,this);this.toolbar.on("delete",this.deleteItem,this);this.toolbar.on("lock",this.toggleLockState,this);this.toolbar.on("visible",this.setVisible,this);this.toolbar.on("visible",this.reFocus,this);this.toolbar.on("viewsize",this.onChangeViewsize,this);this.toolbar.on("viewsize",this.reFocus,this);this.toolbar.on("create:template",this.createTemplate,this);
this.toolbar.on("update:template",this.updateTemplate,this);this.toolbar.on("manage:templates",this.openTemplateManager,this);this.toolbar.on("add:container",this.addContainer,this);this.toolbar.on("add:row",this.addRow,this);this.toolbar.on("add:cell",this.addCell,this);this.toolbar.on("add:widget",this.addWidget,this)},preventBackspaceNav:function(a){var c=event.srcElement||event.target;b(c).is(":input")||b(c).is("[contenteditable]")||8===a.keyCode&&a.preventDefault()},render:function(){wp.media.View.prototype.render.apply(this,
arguments);this.toolbar.render();this.$el.append(this.toolbar.$el);this.$el.append(this.grid.$el);this.grid.render()},setActiveEditor:function(){d.setActiveEditor(this)},onChangeViewsize:function(){this.$el.attr("data-view-size",this.toolbar.whichView())},getSelected:function(){return this.controller.getSelected(this)},checkSelected:function(a){this.$el.has(a.target).length||b(a.target).closest(".grid-ui-modal")||this.setSelected(null)},setSelected:function(a){this.controller.setSelected(a);this.toolbar.update();
a&&!a.$el.is(":focus")&&a.$el.focus();return this},addContainer:function(){var a=arguments.length?d.templates.get("container",arguments[0]):!1,a=a?a.get("data"):{};this._addItem(d.view.element.Container,this.grid,a);return!1},addRow:function(a){var c=this.getSelected().closest(d.view.element.Container),e=arguments.length?d.templates.get("row",arguments[0]):!1,e=e?e.get("data"):{};this._addItem(d.view.element.Row,c,e);return!1},addCell:function(a){var c=this.getSelected().closest(d.view.element.Row),
e=arguments.length?d.templates.get("cell",arguments[0]):!1,e=e?e.get("data"):{size_xs:k.screensizes.columns};this._addItem(d.view.element.Cell,c,e);return!1},addWidget:function(a){var c=this,e=this.getSelected().closest(d.view.element.Cell),b=arguments.length?d.templates.get("widget",arguments[0]):!1,h=b?b.get("data"):{instance:{}},f=new Backbone.Model;b?this._addItem(d.view.element.Widget,e,h):(null===this.selectWidgetModal&&(this.selectWidgetModal=new wp.media.view.Modal({controller:this}),b=new d.view.SelectWidgetDialog({controller:this,
model:f,title:g.SelectWidget}),b.on("done",function(){h.widget_class=f.get("widget_class");c._addItem(d.view.element.Widget,e,h).editItem();c.selectWidgetModal.close()},this.selectWidgetModal),this.selectWidgetModal.content(b)),this.selectWidgetModal.open());return!1},cloneItem:function(){var a=this.getSelected(),c=a.getClass(),b=a.parent(),a=a.model.toJSON();delete a.idx;this._addItem(c,b,a);return!1},_addItem:function(a,c,b){var e=this.getSelected()||this;b=b||{};b=new d.model.GridObject(b);var h=
new a({controller:this.controller,model:b,parent:c}),e=e.closest(a);a=c.$(">.collection");e?h.render().$el.insertAfter(e.$el):a.append(h.render().$el);c.model.items.add(b);this.grid.initSortables();this.grid.hasChanged();this.setSelected(h);return this},getPrevItem:function(a){var c;a=a||this.getSelected();c=a.$el.prev().data("view");_.isUndefined(c)&&!a.parent().is(d.view.element.Grid)?c=a.parent():_.isUndefined(c)||c.is(d.view.element.Widget)||(c=c.$(".widget").last().data("view"));return!l.locks&&
c&&c.model.get("locked")?this.getPrevItem(c):c},getNextItem:function(a){var c;a=a||this.getSelected();c=a.$(">.collection").children().length?a.$(">.collection>*").first().data("view"):a.$el.next().data("view");if(_.isUndefined(c))for(;_.isUndefined(c)&&!a.is(d.view.element.Grid);)a=a.parent(),c=a.$el.next().data("view");return!l.locks&&c&&c.model.get("locked")?this.getNextItem(c):c},toggleLockState:function(){var a=this.getSelected(),c;a&&(c=!!a.model.get("locked"),a.model.set("locked",!c),this.reFocus());
this.toolbar.update()},editItem:function(a){a&&a.preventDefault();if(b("body").hasClass("grid-modal-open"))return!1;var c=this;a=this.getSelected();for(var e=this.getNextItem(a),g=this.getPrevItem(a),h=new f({controller:this,next:!!e,prev:!!g}),l=k.settings[a.getClassName().toLowerCase()],t=k.editors[a.getClassName().toLowerCase()],m,p=[],n=a,r;n&&!n.is(d.view.element.Grid);)r=n.getTitle(),p.unshift(r),n=n.parent();m=new d.view.EditDialog({title:p.join(" \u203a "),controller:this,model:a.model,item:a,
settings:l,editor:t});m.on("done",function(){c.grid.hasChanged();h.close()},h);h.on("close",function(a){m.dismiss();c.getSelected().$el.focus()}).on("next",function(a){m.applyChanges();c.grid.hasChanged();h.close();c.setSelected(e);c.editItem(a)}).on("prev",function(a){m.applyChanges();c.grid.hasChanged();h.close();c.setSelected(g);c.editItem(a)});h.content(m).open();h.$el.focus();return!1},deleteItem:function(a){a&&a.preventDefault();a=this.getSelected();var c=a.parent();c.getClass();a.remove();
c.model.items.remove(a.model);this.grid.hasChanged();return!1},reFocus:function(){var a=this.getSelected();a&&a.reFocus()},setVisible:function(a){var c=this.getSelected(),b="visibility_"+this.toolbar.whichView();c&&(c.model.set(b,a),c.reFocus())},createTemplate:function(){var a=this,c=this.getSelected(),b=new d.model.GridTemplate,f=new d.view.ui.Prompt({title:g.TemplateName,description:g.CreateTemplateDescription,defaultValue:g[c.getClassName()]+" "+g.Template});f.on("confirm",function(e){e=f.getValue();
var g=d.utils.sanitizeTitle(e),h=c.getClassName().toLowerCase();b.set("name",e);b.set("slug",g);b.set("type",h);b.set("data",c.model.toJSON());b.once("sync",function(){var e=b.get("slug");b.set("id",e);c.model.set("template",e);d.templates[h].add(b);toolbar.update();a.grid.hasChanged()});b.save();c.reFocus()},this).open();return!1},updateTemplate:function(){var a=this.getSelected(),b=a.getClassName().toLowerCase(),e=a.model.get("template");template=d.templates.get(b,e);template.set("data",a.model.toJSON());
template.save();a.reFocus();return!1},openTemplateManager:function(){var a=this,b=new wp.media.view.Modal({controller:this}),e=this.getSelected(),f=new d.view.ManageTemplatesDialog({controller:this,title:g.ManageTemplates});f.on("done",function(){b.close()},b);b.content(f).on("close",function(b){a.toolbar.setupTemplateSelects();e&&e.$el.focus()}).open();return!1}});_.extend(d,{getActiveEditor:function(){return active_editor},setActiveEditor:function(a){active_editor=a}})})(jQuery,window.grid);
(function(e,c){function u(){f.inited||(_.each(v,function(a){f[a]=wp.media.View.extend(_.extend({template:wp.template("grid-ui-input-"+a)},w))}),f.inited=!0);return f}var m,n,r,t,h,p,q=gridbuilder.options,k=gridbuilder.options.features,g=gridbuilder.l10n,v="text textarea color number media select checkbox radio range label".split(" "),f={inited:!1},l,w={render:function(){wp.media.View.prototype.render.apply(this,arguments);var a=this;this.$el.addClass("input-"+this.options.settings.name);this.setValue(this.options.value||
this.options.settings["default"]);switch(this.options.settings.type){case "number":_.each(["min","max","step"],function(b){"undefined"!==typeof a.options.settings[b]&&a.$('[type="number"]').attr(b,a.options.settings[b])});break;case "color":this.$("input.color-picker").wpColorPicker({hide:!0,palettes:a.options.settings.palettes});break;case "media":var b=null;this.$(".select-media").on("click",function(){null===b&&(b=wp.media({title:a.options.settings.title,library:{type:a.options.settings.mimetype},
button:{text:g.Done,close:!0}}),b.on("select",function(){var d=b.state().get("selection").first().attributes;a.setValue(d.id)}));b.open()});break;case "range":this.$("input").on("change",function(){a.updateValue()})}this.updateValue();return this},updateValue:function(){this.$(".display-value").text(this.getValue())},setValue:function(a){switch(this.options.settings.type){case "select":this.$("select").val(a);break;case "radio":null===a?this.$('[type="radio"]:checked').prop("checked",!1):this.$('[type="radio"][value="'+
a+'"]').prop("checked",!0);break;case "checkbox":this.$('[type="checkbox"]').prop("checked",!!a);break;case "color":this.$("input.color-picker").val(a);break;case "media":this.$(".thumbnail").html("");if(a){this.$('[name="media_id"]').val(a);var b=new wp.media.model.Attachment({id:a}),d=this;b.once("change",function(){var a,c;if(b.get("sizes"))try{c=b.get("sizes").thumbnail.url}catch(z){c=b.get("sizes").full.url}else c=b.get("icon");a=new wp.media.View({tagName:"span",className:"filename"});a.$el.text(b.get("title"));
d.$(".thumbnail").append(e("<img />").attr("src",c),(new wp.media.view.Button({text:g.RemoveMedia,click:function(){d.setValue(null)}})).$el.addClass("dashicons dashicons-dismiss"),a.$el);delete b});b.fetch()}else this.$('[name="media_id"]').removeAttr("value");break;case "textarea":this.$("textarea").val(a);break;default:this.$("input").val(a)}},getValue:function(){switch(this.options.settings.type){case "select":return this.$("select").val();case "radio":return this.$('[type="radio"]:checked').val();
case "checkbox":return this.$('[type="checkbox"]').prop("checked");case "color":return this.$("input.color-picker").val();case "textarea":return this.$("textarea").val();default:return this.$("input").val()}},dismiss:function(){}};h=wp.media.View.extend({initialize:function(a){wp.media.View.prototype.initialize.apply(this,arguments);this.children=[]},render:function(){var a=this;wp.media.View.prototype.render.apply(this,arguments);_.each(this.children,function(b,d){b.render();a.$el.append(b.$el)})}});
p=h.extend({initialize:function(a){h.prototype.initialize.apply(this,arguments);a.parent&&a.parent.children.push(this)}});f.widget_instance=wp.media.View.extend({tagName:"form",className:"widget-instance",initialize:function(){wp.media.View.prototype.initialize.apply(this,arguments);this.$el.append('<span class="spinner" style="visibility:visible;float:none"></span>');this.$widget=null;var a=this;e.ajax({method:"post",url:q.ajaxurl,complete:function(a,d){},success:function(b,d,y){a.$widget=e(b);a.$el.html("").append(a.$widget);
a.prepareMCE();e(document).trigger("widget-added",[a.$widget])},data:{action:"gridbuilder-get-widget",nonce:q.get_widget_nonce,widget_class:this.options.model.get("widget_class"),instance:JSON.stringify(this.options.model.get("instance"))}});return this},hasMCE:function(){return 0<this.getMCE().length},getMCE:function(a){var b=this.$(".mce-tinymce + textarea, .quicktags-toolbar + textarea"),d=[];_.each(tinyMCE.editors,function(a,c){b.each(function(b,c){c===a.targetElm&&d.push(a)})});return d},getValue:function(){var a=
{};_.each(this.getMCE(),function(a){a.save()});_.each(this.$el.serializeArray(),function(b){var d;d=b.name.match(/\[([a-z0-9-_]+)\]$/g);d=d.length?d[0].replace(/[\[\]]+/g,""):b.name;a[d]=b.value});return a},setValue:function(a){return this},dismiss:function(){e(document).trigger({type:"widget-removed",target:this.$widget});_.each(this.getMCE(),function(a){tinymce.remove(a)});this.resetMCE();return this},prepareMCE:function(){var a=this;this._prevMCE={};l=1E3+parseInt(window.getComputedStyle(this.$el.closest(".grid-ui-modal").get(0)).getPropertyValue("z-index"));
this._prevMCE.FloatPanelZindex=tinyMCE.ui.FloatPanel.zIndex;tinyMCE.ui.FloatPanel.zIndex+=l;this._prevMCE.TooltipRepaint=tinyMCE.ui.Tooltip.prototype.repaint;tinyMCE.ui.Tooltip.prototype.repaint=function(){a._prevMCE.TooltipRepaint.apply(this,arguments);this.getEl().style.zIndex=l+65535+65535};this._prevMCE.NotificationpRepaint=tinyMCE.ui.Notification.prototype.repaint;tinyMCE.ui.Notification.prototype.repaint=function(){a._prevMCE.NotificationpRepaint.apply(this,arguments);var b=this.getEl().style;
b.zIndex=l+65535+65535;console.log(b.zIndex)};this._prevMCE.wpLinkRenderHtml=tinymce.ui.WPLinkPreview.prototype.renderHtml;tinymce.ui.WPLinkPreview.prototype.renderHtml=function(){return a._prevMCE.wpLinkRenderHtml.apply(this,arguments).replace('class="wp-link-preview"','class="wp-link-preview in-grid-modal"')}},resetMCE:function(){this._prevMCE.FloatPanelZindex&&(tinyMCE.ui.FloatPanel.zIndex=this._prevMCE.FloatPanelZindex);this._prevMCE.TooltipRepaint&&(tinyMCE.ui.Tooltip.prototype.repaint=this._prevMCE.TooltipRepaint);
this._prevMCE.NotificationpRepaint&&(tinyMCE.ui.Notification.prototype.repaint=this._prevMCE.NotificationpRepaint);this._prevMCE.wpLinkRenderHtml&&(tinymce.ui.WPLinkPreview.prototype.renderHtml=this._prevMCE.wpLinkRenderHtml)}});t=Backbone.View.extend({tagName:"input",attributes:{type:"text"},events:{'blur [type="text"]':"update"},initialize:function(a){this.property=a.property;this.model=a.model;return this},render:function(){var a=this;Backbone.View.prototype.render.apply(this,arguments);this.$el.on("change",
function(){a.update()});return this},update:function(){this.model.set(this.property,this.$el.val());this.model.save()}});r=wp.media.View.extend({template:wp.template("grid-ui-templates-list"),className:"templates-list",render:function(){wp.media.View.prototype.render.apply(this,arguments);var a=this;this.options.templates.each(function(b,d){var c=new Backbone.View({tagName:"li"}),x=new wp.media.view.Button({model:b,text:"",classes:["delete","dashicons","dashicons-dismiss"],click:function(){this.options.model.destroy();
return!1}}),e=new t({tagName:"input",property:"name",model:b,attributes:{value:b.get("name"),type:"text"}});c.render().$el.append(e.render().$el,x.render().$el);a.$(".templates").append(c.$el);c.listenTo(b,"destroy",function(){this.$el.remove()});e.listenTo(e,"keyup",function(){})});return this}});m=wp.media.View.extend({template:wp.template("grid-ui-input-wrap"),className:"input-wrap",initialize:function(a){var b=u();_.extend(a,{lock:k.locks});wp.media.View.prototype.initialize.apply(this,arguments);
"html"==a.settings.type?(this.$el=e(a.settings.html),this.input={getValue:function(){},setValue:function(){},render:function(){},dismiss:function(){}}):b[a.settings.type]?this.input=new b[a.settings.type](a):(this.input=!1,console.log("no such type",a.settings.type))},render:function(){var a=this;wp.media.View.prototype.render.apply(this,arguments);if(!this.input)return this;this.input.render();this.$(".input").append(this.input.$el);this.$el.addClass("input-type-"+this.options.settings.type);this.setLock(this.options.locked);
this.options.settings.attr&&_.each(this.options.settings.attr,function(b,d){var c=a.$el.attr(d),e=" ";"style"==d&&(e=";");a.$el.attr(d,c+e+b)});return this},getLock:function(){return this.$('.lock [type="checkbox"]').prop("checked")},setLock:function(a){this.$('.lock [type="checkbox"]').prop("checked",a)},getValue:function(){return this.input.getValue()},setValue:function(a){this.input.setValue(a);return this},dismiss:function(){this.input.dismiss();return this}});n=wp.media.View.extend({template:wp.template("grid-ui-input-group"),
className:"input-group",initialize:function(a){wp.media.View.prototype.initialize.apply(this,arguments);var b=this;this.model=a.model;this.inputs=[];_.each(a.settings.items,function(a,c){"matrix"==a.type?b.initializeInputMatrix(a,c):b.initializeInputWrap(a,c)})},initializeInputWrap:function(a,b){var d;d=!1;_.extend(a,{name:b,lock:k.locks&&"label"!=a.type});if(k.locks||!this.model.get(b+":locked"))d=this.model.get(b),d=new m({controller:this.controller,settings:a,value:d?d:null,locked:!!this.model.get(b+
":locked"),model:this.model}),this.inputs.push(d);return d},initializeInputMatrix:function(a,b){var d=this,c=new h({tagName:"table",className:"input-matrix form-table",template:wp.template("grid-ui-input-matrix")});_.each(a.rows,function(a,b){var e=new p({tagName:"tr",parent:c});_.each(a,function(a,b){var c=new p({tagName:"td",parent:e});d.initializeInputWrap(a,b).$parent=c.$el})});d.inputs.push(c)},render:function(){wp.media.View.prototype.render.apply(this,arguments);var a=this;_.each(this.inputs,
function(b){b.render();b.$parent?b.$parent.append(b.$el):a.$(".inputs").append(b.$el)});return this},dismiss:function(){_.each(this.inputs,function(a){a.dismiss&&a.dismiss()});return this}});EditDialog=c.view.EditDialog=c.view.ui.Dialog.extend({template:wp.template("grid-ui-edit-dialog"),className:"edit-dialog sidebar",events:{"click .apply":"done"},initialize:function(a){var b=this;c.view.ui.Dialog.prototype.initialize.apply(this,arguments);this.inputgroups=[];this.editor=new n({controller:this,
model:this.model,settings:{title:"",items:a.editor}});_.each(a.settings,function(a,c){_.extend(a,{name:c});var d=new n({controller:b,model:b.model,settings:a});b.inputgroups.push(d)});return this},render:function(){c.view.ui.Dialog.prototype.render.apply(this,arguments);var a=this;_.each(this.inputgroups,function(b){b.render();a.$(".grid-dialog-sidebar").append(b.$el)});this.$(".grid-dialog-content").append(this.editor.render().$el);return this},applyChanges:function(){function a(a){if(a.options.settings&&
a.options.settings.name){var c=a.options.settings.name;isNaN(parseInt(c))&&(b[c]=a.getValue(),k.locks&&(b[c+":locked"]=a.getLock()))}}var b={};_.each(this.editor.inputs,a);_.each(this.inputgroups,function(b){_.each(b.inputs,a)});this.model.set(b);return this},done:function(){this.applyChanges();this.trigger("done");return!1},dismiss:function(){this.editor.dismiss();_.each(this.inputgroups,function(a){a.dismiss()});c.view.ui.Dialog.prototype.dismiss.apply(this,arguments);return this}});ManageTemplatesDialog=
c.view.ManageTemplatesDialog=c.view.ui.Dialog.extend({template:wp.template("grid-ui-dialog"),className:"manage-templates-dialog",events:{"click .apply":"done"},initialize:function(){c.view.ui.Dialog.prototype.initialize.apply(this,arguments);var a=this;this.templateLists={};_.each(["Container","Row","Cell","Widget"],function(b){a.templateLists[b.toLowerCase()]=new r({title:g[b]+" "+g.Templates,templates:c.templates[b.toLowerCase()]})})},render:function(){c.view.ui.Dialog.prototype.render.apply(this,
arguments);var a=this;_.each(this.templateLists,function(b){a.$(".grid-dialog-content").append(b.render().$el)});return this},done:function(a){this.trigger("done");return!1}});SelectWidgetDialog=c.view.SelectWidgetDialog=c.view.ui.Dialog.extend({template:wp.template("grid-ui-dialog"),className:"select-widget-dialog",events:{'change [name="widget_class"]':"done"},initialize:function(){c.view.ui.Dialog.prototype.initialize.apply(this,arguments);this.selectWidget=new m({model:this.model,settings:{type:"radio",
name:"widget_class",title:g.WidgetTypes,options:q.widgets}})},render:function(){c.view.ui.Dialog.prototype.render.apply(this,arguments);this.$(".grid-dialog-content").append(this.selectWidget.render().$el);return this},done:function(){this.model.set("widget_class",this.selectWidget.getValue());this.selectWidget.setValue(null);this.trigger("done");return!1}})})(jQuery,window.grid);
var $jscomp={scope:{},findInternal:function(b,h,g){b instanceof String&&(b=String(b));for(var m=b.length,n=0;n<m;n++){var q=b[n];if(h.call(g,q,n,b))return{i:n,v:q}}return{i:-1,v:void 0}}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(b,h,g){if(g.get||g.set)throw new TypeError("ES3 does not support getters and setters.");b!=Array.prototype&&b!=Object.prototype&&(b[h]=g.value)};
$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global&&null!=global?global:b};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(b,h,g,m){if(h){g=$jscomp.global;b=b.split(".");for(m=0;m<b.length-1;m++){var n=b[m];n in g||(g[n]={});g=g[n]}b=b[b.length-1];m=g[b];h=h(m);h!=m&&null!=h&&$jscomp.defineProperty(g,b,{configurable:!0,writable:!0,value:h})}};
$jscomp.polyfill("Array.prototype.find",function(b){return b?b:function(b,g){return $jscomp.findInternal(this,b,g).v}},"es6-impl","es3");
(function(b,h){document.caretPositionFromPoint&&!document.caretRangeFromPoint&&(document.caretRangeFromPoint=document.caretPositionFromPoint);var g,m,n,q,u,k,y,z,A,v=gridbuilder.l10n,d=gridbuilder.options,r=gridbuilder.options.features,w={},x={},t=[];_.each(d.screensizes.sizes,function(a,c){w[c]="size_"+c;x[c]="offset_"+c});_.templateSettings={interpolate:/\{\{(.+?)\}\}/g};d.screensizes.size_lock_template=_.template("col-{{screensize}}-lock");d.screensizes.offset_lock_template=_.template("col-{{screensize}}-offset-lock");
d.screensizes.size_class_template=_.template("col-{{screensize}}-{{size}}");d.screensizes.offset_class_template=_.template("col-{{screensize}}-offset-{{size}}");y=wp.media.View.extend({tagName:"div",className:"display-selector",initialize:function(a){this.model=a.model;this.listenTo(this.model,"change",this.render)},render:function(){var a=this.model.get("attr_id"),c=this.model.get("attr_class"),f=this.model.get("locked"),b="";a&&(b+='<span class="display-id">#'+a+"</span>");c&&(b+='<span class="display-class">.'+
c.split(" ").join(".")+"</span>");f&&(b+='<span class="dashicons dashicons-lock"></span>');this.$el.html(b);return this}});z=wp.media.View.extend({tagName:"div",className:"display-template",initialize:function(a){this.model=a.model;this.listenTo(this.model,"change",this.render)},render:function(){var a=this.model.get("template"),c="";a&&(c+=v.Template+": "+a);this.$el.text(c);return this}});k=wp.media.View.extend({events:{dblclick:"edit"},initialize:function(a){this.Subviews=wp.Backbone.Subviews;
this.options=a;this.controller=a.controller;this.model=a.model;this.templateDisplay=new z({model:this.model});this.selectorDisplay=new y({model:this.model});this.listenTo(this.model,"change",this.updateDisplay);(a=this.model.get("template"))&&!h.templates.get(this.getClassName(),a)&&this.model.unset("template");t.push(this);this.$el.data("view",this);return this},edit:function(a){if(r.locks||!this.model.get("locked"))this.controller.setSelected(this).editItem(),a.stopPropagation()},remove:function(){var a=
t.indexOf(this);t.splice(a,1);this.$el.remove()},render:function(){wp.media.View.prototype.render.apply(this,arguments);var a=this,c=this.collectionView(),b=this.$(">.collection");!r.locks&&this.model.get("locked")?this.$el.addClass("locked"):this.$el.addClass("unlocked");b.html("");this.$el.data("model",this.model);b.data("view",this).data("model",this.model.items);c&&this.model.items.each(function(f,l){var e=new c({controller:a.options.controller,model:f,parent:a});b.append(e.$el);e.render()});
this.$el.prepend(this.selectorDisplay.render().$el);this.$el.prepend(this.templateDisplay.render().$el);this.updateDisplay();return this},reFocus:function(){this.$el.focus()},updateDisplay:function(){this.updateVisibilityClasses()},setVisibility:function(a){var c=this.controller.view,b=this.controller.toolbar.whichView();this.model.set("visibility_"+b,a);c.hasChanged()},updateVisibilityClasses:function(){var a=this,c=[],b=[];_.each(d.screensizes.sizes,function(f,l){var e=a.model.get("visibility_"+
l),p="visible-"+l,d="hidden-"+l;"visible"===e?(c.push(p),b.push(d)):"hidden"===e?(c.push(d),b.push(p)):(b.push(p),b.push(d))});this.$el.removeClass(b.join(" ")).addClass(c.join(" "));return this},detach:function(){},is:function(a){return this.constructor===a},closest:function(a){for(var c=this;c&&!c.is(a);)c=c.parent();return c},parent:function(){return this.options.parent},getClass:function(){return this.constructor},getClassName:function(){var a=this,c=_.filter(["Grid","Container","Row","Cell",
"Widget"],function(c){return a.is(A[c])});return c.length?c[0]:!1},hasChanged:function(){this.closest(g).hasChanged()},getTitle:function(){return v[this.getClassName()]}});u=h.view.element.Widget=k.extend({template:wp.template("grid-element-widget"),className:"widget grid-item",tagName:"li",attributes:{tabindex:0},updateDisplay:function(){k.prototype.updateDisplay.apply(this,arguments);this.$(".widget-type").text(this.getTitle());var a=this.model.get("instance").title;this.$(".widget-title").text(a);
return this},collectionView:function(){return!1},getTitle:function(){var a=this.model.get("widget_class");try{return d.widgets[a].name}catch(c){return v.unkonwnWidget+" "+a}}});q=h.view.element.Cell=k.extend({template:wp.template("grid-element-cell"),className:"cell grid-item",tagName:"li",attributes:{tabindex:0},initialize:function(){var a=k.prototype.initialize.apply(this,arguments);this.listenTo(this.model.items,"update",this.itemsChanged);return a},itemsChanged:function(){this.parent().adjustCellSize()},
render:function(){function a(a){a=b.Event("drag",{pageX:a.pageX,pageY:a.pagey,screenX:a.screenX,screenY:a.screeny,clientX:a.clientX,clienty:a.clienty});e.trigger(a)}function c(f){b(document).off("mousemove",a);b(document).off("mouseup",c)}k.prototype.render.apply(this,arguments);var f=this,e,l,g;_.each(w,function(a,c){var b=f.model.get(a);b&&f.setColClass(b,c)});_.each(x,function(a,c){var b=f.model.get(a);isNaN(parseInt(b))||f.setOffsetClass(b,c)});if(r.locks||!this.model.get("locked"))this.$(".resize-handle, .offset-handle").on("mousedown",
function(d){var p=f.controller.toolbar.whichView(),p=(b(this).is(".offset-handle")?"offset_":"size_")+p;if(r.lock||!f.model.get(p+":locked"))l=d.screenX,g=f.getCurrentOffset(),e=b(this),b(document).on("mousemove",a),b(document).on("mouseup",c);d.preventDefault()}),this.$(".resize-handle").on("drag",function(a){var c=b(this).closest(".row").width()/d.screensizes.columns,e=f.controller.toolbar.whichView(),c=Math.max(1,Math.min(d.screensizes.columns,Math.round((a.pageX-f.$el.offset().left)/c)));f.model.get("size_"+
e)!=c&&f.setSize(c,e);a.stopPropagation()}),this.$(".offset-handle").on("drag",function(a){var c=b(this).closest(".row").width()/d.screensizes.columns;viewSize=f.controller.toolbar.whichView();diff=l-a.screenX;offsetDiff=Math.round(diff/c);offset=Math.min(11,Math.max(0,g-offsetDiff));prevOffset=f.model.get("offset_"+viewSize);prevOffset!=offset&&f.setOffset(offset,viewSize);a.stopPropagation();a.stopImmediatePropagation()});return this},getCurrentSize:function(){var a=this.controller.toolbar.whichView(),
c=this,f=!1,e=!1;b.each(w,function(b,d){var l=c.model.get(d);!f&&l&&(e=parseInt(l));b==a&&(f=!0)});console.log(e,f);return e||d.screensizes.columns},setColClass:function(a,c){var b;this.$el.removeClass(this.getColClassnames(c).join(" "));isNaN(parseInt(a))||(b=d.screensizes.size_class_template({screensize:c,size:a}),this.$el.addClass(b));return this},getCurrentOffset:function(){var a=this.controller.toolbar.whichView(),c=this,b=!1,e=!1;offset_key=_.find(x,function(f,d){var l=c.model.get(f);!b&&l&&
(e=parseInt(l));d==a&&(b=!0)});return e||0},setOffsetClass:function(a,c){var b;this.$el.removeClass(this.getColClassnames(c,d.screensizes.offset_class_template).join(" "));isNaN(parseInt(a))||(b=d.screensizes.offset_class_template({screensize:c,size:a}),this.$el.addClass(b));return this},getColClassnames:function(a,c){"undefined"===typeof c&&(c=d.screensizes.size_class_template);for(var b=[],e=0;13>e;e++)b.push(c({screensize:a,size:e}));return b},getLockClassnames:function(a,c){return""},incrementOffset:function(){var a=
this.controller.toolbar.whichView(),c=this.getCurrentOffset();c<d.screensizes.columns-1&&this.setOffset(c+1,a)},decrementOffset:function(){var a=this.controller.toolbar.whichView(),c=this.getCurrentOffset();0<c&&this.setOffset(c-1,a)},incrementSize:function(){var a=this.controller.toolbar.whichView(),c=this.getCurrentSize();c<d.screensizes.columns&&this.setSize(c+1,a)},decrementSize:function(){var a=this.controller.toolbar.whichView(),c=this.getCurrentSize();console.log(c);1<c&&this.setSize(c-1,a)},
setSize:function(a,c){this.model.set("size_"+c,a);this.setColClass(a,c);this.hasChanged()},setOffset:function(a,c){this.setOffsetClass(a,c);this.model.set("offset_"+c,a);this.hasChanged()},updateDisplay:function(){k.prototype.updateDisplay.apply(this,arguments);this.updateColLockClasses();this.updateSizeClasses();this.updateOffsetClasses()},updateSizeClasses:function(){var a=this;_.each(d.screensizes.sizes,function(c,b){var e=a.model.get("size_"+b);a.setColClass(e,b)})},updateOffsetClasses:function(){var a=
this;_.each(d.screensizes.sizes,function(c,b){var e=a.model.get("offset_"+b);a.setOffsetClass(e,b)})},updateColLockClasses:function(){var a=this,c=[],b=[];_.each(d.screensizes.sizes,function(e,f){_.each({size:d.screensizes.size_lock_template,offset:d.screensizes.offset_lock_template},function(e,d){var l=e({screensize:f});a.model.get(d+"_"+f+":locked")?c.push(l):b.push(l)})});this.$el.removeClass(b.join(" ")).addClass(c.join(" "))},collectionView:function(){return u}},k);n=h.view.element.Row=k.extend({template:wp.template("grid-element-row"),
className:"row grid-item",tagName:"li",attributes:{tabindex:0},initialize:function(){k.prototype.initialize.apply(this,arguments);return this},render:function(){k.prototype.render.apply(this,arguments);var a=this;setTimeout(function(){a.adjustCellSize()},1);return this},adjustCellSize:function(){var a=this.$(".cell"),c=0;a.each(function(a,e){b(this).removeAttr("style");c=Math.max(c,b(this).height())});a.each(function(){b(this).css({height:c+"px"})});return this},collectionView:function(){return q}});
m=h.view.element.Container=k.extend({template:wp.template("grid-element-container"),className:"container grid-item",tagName:"li",attributes:{tabindex:0},initialize:function(){k.prototype.initialize.apply(this,arguments);return this},render:function(){k.prototype.render.apply(this,arguments);this.setCollapsed(this.model.get("collapsed"));return this},collectionView:function(){return n},toggleCollapsed:function(a){var b=!this.model.get("collapsed");this.setCollapsed(b);a.preventDefault()},setCollapsed:function(a){this.$el.toggleClass("collapsed",
!!a);this.model.set("collapsed",!!a);this.$(">.collection .row").each(function(){b(this).data("view").adjustCellSize()})}});m.prototype.events["click .toggle-collapse"]="toggleCollapsed";g=h.view.element.Grid=k.extend({template:wp.template("grid-element-grid"),className:"grid-view grid-item",tagName:"div",attributes:{"data-grid-columns":d.screensizes.columns},events:{},initialize:function(){k.prototype.initialize.apply(this,arguments);this.selectWidgetModal=null;this.templateSelectOptions=[]},render:function(){k.prototype.render.apply(this,
arguments);this.$el.removeAttr("tabindex");this.initSortables();this.controller.setSelected(this);return this},renderTemplateSelects:function(){var a=this;_.each(this.templateSelectOptions,function(b){b.stopListening();b.remove();a.stopListening(b.model)});_.each(["container","row","cell","widget"],function(b){var c=a.$("select.add-"+b);h.templates[b].each(function(b){var e=b.get("slug"),e=new Backbone.View({tagName:"option",attributes:{value:e},model:b});e.render().$el.text(b.get("name"));c.append(e.$el);
e.listenTo(b,"change",function(){this.$el.text(this.model.get("name"))});a.listenTo(b,"destroy",function(){var c=!1;_.each(t,function(a,e){a.model.get("template")===b.id&&(a.model.unset("template"),c=!0)});c&&a.hasChanged()});a.templateSelectOptions.push(e)})})},initSortables:function(){var a={ghostClass:"ghost",scroll:!0};b('[data-sort-group="cell"]').on("add remove",function(a){});_.each(["container","row","cell","widget"],function(c){var d=b.extend({group:c,handle:".sort-handle"},a);b('.unlocked>[data-sort-group="'+
c+'"]').sortable(d).on("add",function(a){var c=b(this).data("model"),e=b(this).data("view"),d=b(a.originalEvent.item).data("view");c.add(b(a.originalEvent.item).data("model"),{silent:!0});c.trigger("update");d.options.parent=e;a.stopPropagation()}).on("remove",function(a){var c=b(this).data("model");c.remove(b(a.originalEvent.item).data("model"),{silent:!0});c.trigger("update");a.stopPropagation()}).on("sort",function(a){b(this).children().each(function(a,c){b(c).data("model").set("idx",a)});b(this).data("model").sort();
a.stopPropagation()})})},setItemVisibility:function(a){(a=this.getSelected())&&a.setVisibility(this.$('[name="set-visibility"]:checked').val())},collectionView:function(){return m},hasChanged:function(){this.model.trigger("change",this.model)}});A={Grid:g,Container:m,Row:n,Cell:q,Widget:u}})(jQuery,window.grid);
(function(a,k){var g=gridbuilder.l10n,l=gridbuilder.options.default_widget,m=gridbuilder.options.default_widget_content_property,d;a(document).ready(function(){var e,f=!!parseInt(a('[name="_grid_enabled"]').val()),n='<input type="hidden" name="_grid_enabled" value="'+(f?1:0).toString()+'" />',p='<button type="button" id="edit-content-grid" class="button-secondary toggle-grid-editor">'+g.EditGrid+"</button>",q='<button type="button" id="edit-content-text" class="button-secondary toggle-grid-editor">'+
g.EditText+"</button>",r=a('[name="_grid_data"]').val(),h=!JSON.parse(r);e=null;d=function(b){b=_.isUndefined(b)?"true"!==a("#postdivrich").attr("date-grid-editor-mode"):b;var c;a("#postdivrich").attr("date-grid-editor-mode",b.toString());a('[name="_grid_enabled"]').val(b?1:0);b||a(window).trigger("resize");b&&h&&(c={widget_class:l,instance:{}},c.instance[m]=a('textarea[name="content"]').val(),c={items:[{items:[{items:[{size_xs:12,items:[c]}]}]}]},a('[name="_grid_data"]').val(JSON.stringify(c)),h=
!1);b&&!e&&(e=new k.controller.Grid)};a("#postdivrich").attr("date-grid-editor-mode",f.toString()).prepend('<div id="grid-toggle-wrap" class="grid-toolbar"><div class="toolbar-right">'+n+p+q+"</div></div>");d(f);"undefined"!==typeof bstw_data&&bstw_data.deactivate_events.push("deactivate-tinymce")}).on("click",".toggle-grid-editor",function(a){d()})})(jQuery,window.grid);
